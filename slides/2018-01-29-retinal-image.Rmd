---
title: "2018-01-29 The retinal image"
subtitle: "PSY 525.001 • Vision Science • 2018 Spring"
author: "Rick Gilmore"
date: "`r Sys.time()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(psyphy)
library(imager)
```

---

# Today's topics

--
## The retinal image

--
## Discuss Fourier analysis, esp. Campbell & Robson 1968.

---
class: center, middle, inverse

# The retinal image

---
class: center, middle

# Human retina

<img src="http://webvision.med.utah.edu/imageswv/Sagschem.jpeg"/>

<http://webvision.med.utah.edu/>
---

class: center, middle

<img src="http://webvision.med.utah.edu/imageswv/schem.jpeg"/>

<http://webvision.med.utah.edu/>

---
class: center, middle

## Ganglion cell response properties differ across cells

## Individual response function of stimulus location, size

## On- and off-center cells

## Receptive fields have *center-surround* structure, due to *lateral inhibition*

---
class: center, middle

<p><a href="https://commons.wikimedia.org/wiki/File:Receptive_field.png#/media/File:Receptive_field.png"><img src="https://upload.wikimedia.org/wikipedia/commons/1/16/Receptive_field.png" alt="Receptive field.png"></a><br>By original uploaded to en by <a href="//commons.wikimedia.org/wiki/User:Delldot" title="User:Delldot">user:delldot</a>, modified by <a href="//commons.wikimedia.org/w/index.php?title=User:Xoneca&amp;action=edit&amp;redlink=1" class="new" title="User:Xoneca (page does not exist)">Xoneca</a> - <span class="int-own-work" lang="en" xml:lang="en">Own work</span>, Public Domain, <a href="https://commons.wikimedia.org/w/index.php?curid=5714283">Link</a></p>


---
class: center, middle

<img src="http://webvision.med.utah.edu/imageswv/catwir1.jpeg">

photoreceptors -> horizontal cells; photoreceptors + horizontal cells -> bipolar cells; bipolar cells -> amacrine + ganglion cells; bipolar + amacrine -> ganglion cells

---
class: center, middle

<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Human_visual_pathway.svg/2000px-Human_visual_pathway.svg.png">

## Retina -> Lateral Geniculate Nucleus (LGN) of thalamus

---
class: center, middle

<img src="http://www.cns.nyu.edu/~david/courses/perception/lecturenotes/V1/LGN-V1-slides/Slide6.jpg">

---
class: center, middle

<img src="http://www.cns.nyu.edu/~david/courses/perception/lecturenotes/V1/LGN-V1-slides/Slide7.jpg">

## Parvocellular (small cell) and magnocellular (large cell) layers

## Inputs from ipsilateral (2, 3, 5) and contralateral (1, 4, 6) eye separate by layer

## Retinal geometry aligned

---
class: center, middle

# Magno vs. parvo LGN cells

| Characteristic       | Parvo | Magno |
|----------------------|-------|-------|
| Color sensitivity    | High  | Low   |
| Contrast sensitivity | Low   | High  |
| Spatial resolution   | High  | Low   |
| Temporal resolution  | Slow  | Fast  |
| Receptive field size | Small | Large |

Palmer Table 4.1.1

---
class: center, middle

# Visual cortex

<img src="http://hubel.med.harvard.edu/book/96.jpg">

Striate cortex (stria of Gennari), V1, area 17

---
class: center, middle

<img src="http://hubel.med.harvard.edu/book/97.jpg">

---
class: center, middle

<iframe width="560" height="315" src="https://www.youtube.com/embed/IOHayh06LJ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

---
class: center, middle
## Center-surround cells rare

## Simple cells, complex cells, & hypercomplex cells were elongated

---
class: center, middle

<img src="https://i.stack.imgur.com/k7w8a.png" height=500px>

## Simple cells

---
class: center, middle
## Orientation (angular) selectivity

<img src="http://www.cns.nyu.edu/~david/courses/perception/lecturenotes/V1/LGN-V1-slides/Slide15.jpg">

---
class: middle
## Complex cells nonlinear, motion sensitive, position invariance, spatially extended

<img src="http://fourier.eng.hmc.edu/e180/lectures/figures/simplecell.gif">

---
class: center, middle
## Hypercomplex (end-stopped) cells

<img src="https://upload.wikimedia.org/wikipedia/en/thumb/1/10/Hypercomplex_Cell.pdf/page1-1169px-Hypercomplex_Cell.pdf.jpg">



---
class: center, middle

<img src="https://cdn-images-1.medium.com/max/1600/1*YBRgHpwpH8loHlh9PW1tqg.png">

## Cortical magnification

---
class: center, middle

<img src="http://cns.bu.edu/~arash/animation.gif">

---
class: center, middle

<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Retinotopic_English.jpg/1200px-Retinotopic_English.jpg">

## Retinotopy

---
class: center, middle

<img src="https://pachouinard.files.wordpress.com/2015/11/retinotopy.jpg">

---
class: center, middle

<iframe width="560" height="315" src="https://www.youtube.com/embed/HCLgh9AwvrQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

Zhuang, J., Ng, L., Williams, D., Valley, M., Li, Y., Garrett, M., & Waters, J. (2017). An extended retinotopic map of mouse cortex. eLife, 6. Retrieved from http://dx.doi.org/10.7554/eLife.18372

---
class: center, middle

<img src="https://classconnection.s3.amazonaws.com/737/flashcards/1944737/png/ocular_dominance-1417BBEAF0A21B6A361.png"/>

## Ocular dominance

---
class: center, middle

<img src="http://thebrain.mcgill.ca/flash/a/a_02/a_02_cl/a_02_cl_vis/a_02_cl_vis_3d.jpg">

## Cortical hypercolumn

---
class: center

# Aspects of the retinal-> V1 image

## Topographic, but non-uniform

## Functionally segregated (on/off center, wavelength, eye of origin)

---
class: center, middle, inverse

# Break time

---
class: center, middle, inverse

# Spatial frequency analysis

<img src="http://www.ucalgary.ca/pip369/files/pip369/sine-wave.jpg">

---
class: middle

<!-- $$i(x)=sin(2\pi fx+\theta)$$ -->
```{r}
pix_per_img <- 100
x <- (1:pix_per_img)/pix_per_img  # Make x on (0,1]
cyc_per_img <- 2                  # spatial frequency f
phase <- 0
one_row <- sin(2*pi*cyc_per_img*x + phase)
plot(one_row)
```

---
class: middle

```{r}
sin_array <- array(rep(one_row, pix_per_img), 
                   dim = c(pix_per_img, pix_per_img))
sin_img <- as.cimg(sin_array) # Nice image format from package imager
plot(sin_img)
```

---
class: middle
```{r}
vertical_grating <- function(pix_per_img=100, cyc_per_img=1, phase=0){
  x <- (1:pix_per_img)/pix_per_img 
  one_row <- sin(2*pi*cyc_per_img*x + phase)
  as.cimg(array(rep(one_row, pix_per_img), 
                   dim = c(pix_per_img, pix_per_img)))
}
```

---
class: middle

```{r}
plot(vertical_grating(cyc_per_img = 5))
```

---
class: middle
```{r}
vertical_grating <- function(pix_per_img=100, cyc_per_img=1, phase=0){
  x <- (1:pix_per_img)/pix_per_img 
  one_row <- sin(2*pi*cyc_per_img*x + phase)
  as.cimg(array(rep(one_row, pix_per_img), 
                   dim = c(pix_per_img, pix_per_img)))
}
```

---
# Under the hood

- Value at each $x,y$ pixel is a number $[-1,1]$ (for grayscale)
- `plot` scales that to [0,255] (dark to light)
- [0,255] has 256 levels, $2^8=256$, so this is '8-bit grayscale'
- 8-bit color has 3 numbers at each pixel, $(r,g,b)$, one each for the **r**ed, **g**reen, and **b**lue values.

---
class: middle, center

# Synthesizing images from sums of gratings

## Every periodic pattern consists of an infinite sum of gratings of different spatial frequency, amplitude, phase, and orientation

---
class: middle

```{r}
f1 <- vertical_grating(pix_per_img = 50, cyc_per_img = 1)
f3 <- vertical_grating(pix_per_img = 50, cyc_per_img = 3)
f5 <- vertical_grating(pix_per_img = 50, cyc_per_img = 5)
plot(f1); plot((1/3)*f3); plot(f5)
```

---
class: center, middle

## What is Fourier analysis?

## Why is it useful and important for vision science?

## Why is it useful and important for other areas of psychological or neural science?

---
# Next time...

---
class: center, middle

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan). Rendered HTML and supporting files are pushed to GitHub where GitHub's 'pages' feature is used to host and serve the course website.
